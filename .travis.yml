language: haskell

dist: xenial

git:
  depth: 5

cabal: "3.2"

cache:
  directories:
  - "$HOME/.cabal/store"
  - "$HOME/.stack"
  - "$TRAVIS_BUILD_DIR/.stack-work"
  - "$TRAVIS_BUILD_DIR/dist-newstyle"

matrix:
  include:
  - ghc: 8.8.3

addons:
  apt:
    update: true
    packages:
      - libgc-dev

install:
  - |
    clang --version
    ghc --version
    cabal --version
    cabal new-update
    cabal install hspec-discover
    cabal new-build all --enable-tests --enable-benchmarks

script:
  - |
    cabal new-test all --enable-tests
    ./test.sh
    ./test_griff.sh