(def if (lambda (:p1) (object (field then (lambda (:p2) (object (field else (lambda (:p3) (case ((var :p1) (var :p2) (var :p3)) (clause ((literal 0) (var t) (var e)) (seq (call (var e)))) (clause ((var _) (var t) (var e)) (seq (call (var t)))))))))))))
(def le (lambda (:p1 :p2) (case ((var :p1) (var :p2)) (clause ((var x) (var y)) (seq (prim less_equal (var x) (var y)))))))
(def dec (lambda (:p1) (case ((var :p1)) (clause (var x) (seq (prim sub (var x) (literal 1)))))))
(def tarai (lambda (:p1 :p2 :p3) (case ((var :p1) (var :p2) (var :p3)) (clause ((var x) (var y) (var z)) (seq (call (access (call (access (call (var if) (call (var le) (var x) (var y))) then) (lambda () (seq (var y)))) else) (lambda () (seq (call (var tarai) (call (var tarai) (call (var dec) (var x)) (var y) (var z)) (call (var tarai) (call (var dec) (var y)) (var z) (var x)) (call (var tarai) (call (var dec) (var z)) (var x) (var y)))))))))))
(def main (lambda () (seq (prim print_trace (call (var tarai) (literal 2) (literal 1) (literal 0))))))
